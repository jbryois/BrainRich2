---
title: "gene_set_expression_check"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(tidytext)
library(patchwork)
theme_set(theme_light())
```

```{r}
skene_order <- read_tsv("../Data/Skene_lvl1.1to1.order.txt",col_names = FALSE)
skene <- read_tsv("../Data/Skene_lvl1.1to1.norm.txt") %>% mutate(Lvl5=factor(Lvl5,levels=skene_order$X1))
skene_lvl2 <- read_tsv("../Data/Skene_lvl2.1to1.norm.txt") 
zeisel <- read_tsv("../Data/Zeisel.1to1.norm.txt")
zeisel_lvl4 <- read_tsv("../Data/Zeisel.lvl4.1to1.norm.txt")
habib <- read_tsv("../Data/Habib.norm.txt")
lake <- read_tsv("../Data/Lake.norm.txt")
```

# Functions

```{r}
plot_gene_set_scaled10k <- function(d,gene_set){
filter(d,geneName%in%gene_set) %>% 
    #mutate(geneName=factor(geneName,levels=gene_set)) %>% 
    ggplot(.,aes(Lvl5,Expr_sum_mean_scaled10k,fill=Lvl5)) + geom_col() + coord_flip() + 
    theme(legend.position = "none") + xlab("") + ylab("Expression (scaled 10k)") + 
    facet_wrap(~geneName,scales = "free_x")
}

plot_gene_set_scaled10k_top15 <- function(d,gene_set){
filter(d,geneName%in%gene_set) %>% 
    group_by(geneName) %>% 
    mutate(rank=rank(-Expr_sum_mean_scaled1pergene,ties.method="random")) %>% 
    filter(rank <=15) %>%
    ungroup() %>%
    #mutate(geneName=factor(geneName,levels=gene_set) %>%
    mutate(Lvl5=reorder_within(Lvl5,Expr_sum_mean_scaled10k,geneName)) %>% 
    ggplot(.,aes(Lvl5,Expr_sum_mean_scaled10k,fill=geneName)) + geom_col() + 
    coord_flip() + 
    theme(legend.position = "none") + xlab("") + ylab("Expression (scaled 10k)") + 
    facet_wrap(~geneName,scales = "free") +
    scale_x_reordered() 
}
```

```{r}
plot_gene_set_scaled1pergene <- function(d,gene_set){
filter(d,geneName%in%gene_set) %>%
    #mutate(geneName=factor(geneName,levels=gene_set)) %>% 
    ggplot(.,aes(Lvl5,Expr_sum_mean_scaled1pergene,fill=Lvl5)) + geom_col() + coord_flip() + 
    theme(legend.position = "none") + xlab("") + ylab("Expression (scaled 1 UMI per Gene)") + 
    facet_wrap(~geneName,scales = "free_x")
}

plot_gene_set_scaled1pergene_top15 <- function(d,gene_set){
filter(d,geneName%in%gene_set) %>% 
    group_by(geneName) %>% 
    mutate(rank=rank(-Expr_sum_mean_scaled1pergene,ties.method="random")) %>% 
    filter(rank <=15) %>%
    ungroup() %>%
    #mutate(geneName=factor(geneName,levels=gene_set) %>%
    mutate(Lvl5=reorder_within(Lvl5,Expr_sum_mean_scaled1pergene,geneName)) %>% 
    ggplot(.,aes(Lvl5,Expr_sum_mean_scaled1pergene,fill=geneName)) + geom_col() + 
    coord_flip() + 
    theme(legend.position = "none") + xlab("") + ylab("Expression (scaled 1 UMI per Gene)") + 
    facet_wrap(~geneName,scales = "free") +
    scale_x_reordered() 
}
```

```{r}
plot_gene_set_raw <- function(d,gene_set){
filter(d,geneName%in%gene_set) %>%
    #mutate(geneName=factor(geneName,levels=gene_set)) %>% 
    ggplot(.,aes(Lvl5,Expr_sum_mean_raw,fill=Lvl5)) + geom_col() + coord_flip() + 
    theme(legend.position = "none") + xlab("") + ylab("Expression (Raw)") + 
    facet_wrap(~geneName,scales = "free_x")
}

plot_gene_set_raw_top15 <- function(d,gene_set){
filter(d,geneName%in%gene_set) %>% 
    group_by(geneName) %>% 
    mutate(rank=rank(-Expr_sum_mean_raw,ties.method="random")) %>% 
    filter(rank <=15) %>%
    ungroup() %>%
    #mutate(geneName=factor(geneName,levels=gene_set) %>%
    mutate(Lvl5=reorder_within(Lvl5,Expr_sum_mean_scaled1pergene,geneName)) %>% 
    ggplot(.,aes(Lvl5,Expr_sum_mean_scaled1pergene,fill=geneName)) + geom_col() + 
    coord_flip() + 
    theme(legend.position = "none") + xlab("") + ylab("Expression (Raw)") + 
    facet_wrap(~geneName,scales = "free") +
    scale_x_reordered() 
}
```

# Gene sets

```{r}
gene_set_test <- c("APOE","DRD2","CACNA1C","C4A")
gene_set_coloc_all <- read_tsv("~/Documents/Data/Gene_sets/CMC_conditional_analysis/colocCMC_published.txt")
gene_set_coloc <- read_tsv("~/Documents/Data/Gene_sets/CMC_conditional_analysis/colocCMC_published_gene_parsed.txt",col_names = FALSE)
gene_set_exome <- readxl::read_xlsx("~/Documents/Data/Gene_sets/SCZ_exome_seq/schema scz exome sig genes.xlsx")
tada65 <- read_tsv("/Users/julienbryios/Documents/Data/Gene_sets/Autism_genes2/asd.tada65.txt")
ap <- read_tsv("/Users/julienbryios/Documents/Data/Gene_sets/Antipsychotic_targets/antipsychotic.txt",skip=4,col_names=FALSE)
syngoBP <- read_tsv("/Users/julienbryios/Documents/Data/Gene_sets/SynGO/SynGO_genesets_v1.0_2018-07-31/Processed/SYNGO.BP.10genes.min.binary.hgnc.txt")
park_info  <- read_tsv("~/Documents/Data/Gene_sets/Parkinson_Klein_2012/table.txt") %>% filter(grepl("Confirmed",Status.and.remarks),Gene!="Unknown") 
park <- c("SNCA","PRKN","PARK7","PINK1","LRRK2","ATP13A2","PLA2G6","FBX07","VPS35")
park2 <- read_tsv("~/Documents/Data/Projects/Best_tissue2/Paper/Nature_Genetics_submission/v10/Tables/TableS12.txt") %>% rename(Parkinsonism = `Parkinsonism associated genes (Source:`)
```

# Plots

## Skene lvl 1

### Test 

```{r}
p1 <- plot_gene_set_scaled10k(skene,gene_set_test) + ggtitle("Scaled 10k")
p2 <- plot_gene_set_scaled1pergene(skene,gene_set_test) + ggtitle("Scaled 1 UMI per gene")
p <- p1 + p2
dir.create("../Plots/Skene_lvl1//Test/",showWarnings = FALSE,recursive = TRUE)
ggsave(p,filename = "../Plots/Skene_lvl1/Test/test_genes.pdf", width = 12,height=5)
```

```{r}
p1 <- plot_gene_set_scaled10k_top15(skene,gene_set_test) + ggtitle("Scaled 10k")
p2 <- plot_gene_set_scaled1pergene_top15(skene,gene_set_test) + ggtitle("Scaled 1 UMI per gene")
p <- p1 + p2 
dir.create("../Plots/Skene_lvl1/Test/",showWarnings = FALSE,recursive = TRUE)
ggsave(p,filename = "../Plots/Skene_lvl1/Test/test_genes.top15.pdf", width = 24,height=5)
```

### SCZ Coloc

Paper: Landscape of Conditional eQTL in Dorsolateral Prefrontal Cortex and Co-localization with Schizophrenia GWAS

```{r}
p <- plot_gene_set_scaled10k(skene,gene_set_coloc$X1)
p2 <- plot_gene_set_scaled1pergene(skene,gene_set_coloc$X1)
p3 <- plot_gene_set_scaled10k_top15(skene,gene_set_coloc$X1)
p4 <- plot_gene_set_scaled1pergene_top15(skene,gene_set_coloc$X1)

dir.create("../Plots/Skene_lvl1/SCZ_coloc/")
#ggsave(p,filename = "../Plots/Zeisel/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf", width = 16,height=20)
#ggsave(p2,filename = "../Plots/Zeisel/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.pdf", width = 16,height=20)
ggsave(p3,filename = "../Plots/Skene_lvl1/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf.top15.pdf", width = 24,height=20)
ggsave(p4,filename = "../Plots/Skene_lvl1/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.top15.pdf", width = 24,height=20)
```

### SCZ Exome   

```{r}
p <- plot_gene_set_scaled10k(skene,gene_set_exome$geneName)
p2 <- plot_gene_set_scaled1pergene(skene,gene_set_exome$geneName)
p3 <- plot_gene_set_scaled10k_top15(skene,gene_set_exome$geneName)
p4 <- plot_gene_set_scaled1pergene_top15(skene,gene_set_exome$geneName)

dir.create("../Plots/Skene_lvl1/SCZ_exome/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/SCZ_exome/SCZ_exome_scaled10k.pdf", width = 12,height=10)
#ggsave(p2,filename = "../Plots/Zeisel/SCZ_exome/SCZ_exome_scaled1pergene.pdf", width = 12,height=10)
ggsave(p3,filename = "../Plots/Skene_lvl1/SCZ_exome/SCZ_exome_scaled10k.top15.pdf", width = 12,height=10)
ggsave(p4,filename = "../Plots/Skene_lvl1/SCZ_exome/SCZ_exome_scaled1pergene.top15.pdf", width = 12,height=10)
```

### Autism TADA 65   

```{r}
p <- plot_gene_set_scaled10k(skene,tada65$asd.tada65)
p2 <- plot_gene_set_scaled1pergene(skene,tada65$asd.tada65)
p3 <- plot_gene_set_scaled10k_top15(skene,tada65$asd.tada65)
p4 <- plot_gene_set_scaled1pergene_top15(skene,tada65$asd.tada65)

dir.create("../Plots/Skene_lvl1/Autism_tada65/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/Autism_tada65/Autism_tada65_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Zeisel/Autism_tada65/Autism_tada65_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Skene_lvl1/Autism_tada65/Autism_tada65_scaled10k.top15.pdf", width = 30,height=22)
ggsave(p4,filename = "../Plots/Skene_lvl1/Autism_tada65/Autism_tada65_scaled1pergene.top15.pdf", width = 30,height=22)
```

### Antipsychotics

```{r}
p <- plot_gene_set_scaled10k(skene,ap$X1)
p2 <- plot_gene_set_scaled1pergene(skene,ap$X1)
p3 <- plot_gene_set_scaled10k_top15(skene,ap$X1)
p4 <- plot_gene_set_scaled1pergene_top15(skene,ap$X1)

dir.create("../Plots/Skene_lvl1/Antipsychotics/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl1/Antipsychotics/Antipsychotics_scaled10k.pdf", width = 16,height=28)
#ggsave(p2,filename = "../Plots/Skene_lvl1/Antipsychotics/Antipsychotics_scaled1pergene.pdf", width = 16,height=28)
ggsave(p3,filename = "../Plots/Skene_lvl1/Antipsychotics/Antipsychotics_scaled10k.top15.pdf", width = 40,height=20)
ggsave(p4,filename = "../Plots/Skene_lvl1/Antipsychotics/Antipsychotics_scaled1pergene.top15.pdf", width = 40,height=20)
```

### SYNGO postsynaptic strucutral constituent

```{r}
syngo_postsynapse_struct <- syngoBP$ENTREZ[ifelse(syngoBP$`structural constituent of postsynapse (GO:0099186)`==1,TRUE,FALSE)]
p <- plot_gene_set_scaled10k(skene,syngo_postsynapse_struct)
p2 <- plot_gene_set_scaled1pergene(skene,syngo_postsynapse_struct)
p3 <- plot_gene_set_scaled10k_top15(skene,syngo_postsynapse_struct)
p4 <- plot_gene_set_scaled1pergene_top15(skene,syngo_postsynapse_struct)

dir.create("../Plots/Skene_lvl1/SYNGO_postsynapse_struct/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl1/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl1/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Skene_lvl1/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.top15.pdf", width = 24,height=18)
ggsave(p4,filename = "../Plots/Skene_lvl1/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.top15.pdf", width = 24,height=18)
```

### Parkinson Klein 2012

```{r}
p <- plot_gene_set_scaled10k(skene,park)
p2 <- plot_gene_set_scaled1pergene(skene,park)
p3 <- plot_gene_set_scaled10k_top15(skene,park)
p4 <- plot_gene_set_scaled1pergene_top15(skene,park)

dir.create("../Plots/Skene_lvl1/Parkinson_Klein/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl1/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl1/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Skene_lvl1/Parkinson_Klein/Parkinson_Klein_scaled10k.top15.pdf", width = 12,height=9)
ggsave(p4,filename = "../Plots/Skene_lvl1/Parkinson_Klein/Parkinson_Klein_scaled1pergene.top15.pdf", width = 12,height=9)
```

### Parkinsonism

```{r}
p <- plot_gene_set_scaled10k(skene,park2$Parkinsonism)
p2 <- plot_gene_set_scaled1pergene(skene,park2$Parkinsonism)
p3 <- plot_gene_set_scaled10k_top15(skene,park2$Parkinsonism)
p4 <- plot_gene_set_scaled1pergene_top15(skene,park2$Parkinsonism)

dir.create("../Plots/Skene_lvl1/Parkinsonism/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl1/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl1/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Skene_lvl1/Parkinsonism/Parkinsonism_scaled10k.top15.pdf", width = 40,height=20)
ggsave(p4,filename = "../Plots/Skene_lvl1/Parkinsonism/Parkinsonism_scaled1pergene.top15.pdf", width = 40,height=20)
```

## Skene lvl 2

### Test 

```{r}
p1 <- plot_gene_set_scaled10k(skene_lvl2,gene_set_test) + ggtitle("Scaled 10k")
p2 <- plot_gene_set_scaled1pergene(skene_lvl2,gene_set_test) + ggtitle("Scaled 1 UMI per gene")
p <- p1 + p2
dir.create("../Plots/Skene_lvl2/Test/",showWarnings = FALSE,recursive = TRUE)
ggsave(p,filename = "../Plots/Skene_lvl2/Test/test_genes.pdf", width = 12,height=24)
```

```{r}
p1 <- plot_gene_set_scaled10k_top15(skene_lvl2,gene_set_test) + ggtitle("Scaled 10k")
p2 <- plot_gene_set_scaled1pergene_top15(skene_lvl2,gene_set_test) + ggtitle("Scaled 1 UMI per gene")
p <- p1 + p2 
dir.create("../Plots/Skene_lvl2/Test/",showWarnings = FALSE,recursive = TRUE)
ggsave(p,filename = "../Plots/Skene_lvl2/Test/test_genes.top15.pdf", width = 32,height=5)
```

### SCZ Coloc

Paper: Landscape of Conditional eQTL in Dorsolateral Prefrontal Cortex and Co-localization with Schizophrenia GWAS

```{r}
p <- plot_gene_set_scaled10k(skene_lvl2,gene_set_coloc$X1)
p2 <- plot_gene_set_scaled1pergene(skene_lvl2,gene_set_coloc$X1)
p3 <- plot_gene_set_scaled10k_top15(skene_lvl2,gene_set_coloc$X1)
p4 <- plot_gene_set_scaled1pergene_top15(skene_lvl2,gene_set_coloc$X1)

dir.create("../Plots/Skene_lvl2/SCZ_coloc/")
#ggsave(p,filename = "../Plots/Skene_lvl2/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf", width = 16,height=20)
#ggsave(p2,filename = "../Plots/Skene_lvl2/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.pdf", width = 16,height=20)
ggsave(p3,filename = "../Plots/Skene_lvl2/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf.top15.pdf", width = 36,height=20)
ggsave(p4,filename = "../Plots/Skene_lvl2/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.top15.pdf", width = 36,height=20)
```

### SCZ Exome   

```{r}
p <- plot_gene_set_scaled10k(skene_lvl2,gene_set_exome$geneName)
p2 <- plot_gene_set_scaled1pergene(skene_lvl2,gene_set_exome$geneName)
p3 <- plot_gene_set_scaled10k_top15(skene_lvl2,gene_set_exome$geneName)
p4 <- plot_gene_set_scaled1pergene_top15(skene_lvl2,gene_set_exome$geneName)

dir.create("../Plots/Skene_lvl2/SCZ_exome/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl2/SCZ_exome/SCZ_exome_scaled10k.pdf", width = 12,height=10)
#ggsave(p2,filename = "../Plots/Skene_lvl2/SCZ_exome/SCZ_exome_scaled1pergene.pdf", width = 12,height=10)
ggsave(p3,filename = "../Plots/Skene_lvl2/SCZ_exome/SCZ_exome_scaled10k.top15.pdf", width = 24,height=10)
ggsave(p4,filename = "../Plots/Skene_lvl2/SCZ_exome/SCZ_exome_scaled1pergene.top15.pdf", width = 24,height=10)
```


### Autism TADA 65   

```{r}
p <- plot_gene_set_scaled10k(skene_lvl2,tada65$asd.tada65)
p2 <- plot_gene_set_scaled1pergene(skene_lvl2,tada65$asd.tada65)
p3 <- plot_gene_set_scaled10k_top15(skene_lvl2,tada65$asd.tada65)
p4 <- plot_gene_set_scaled1pergene_top15(skene_lvl2,tada65$asd.tada65)

dir.create("../Plots/Skene_lvl2/Autism_tada65/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl2/Autism_tada65/Autism_tada65_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl2/Autism_tada65/Autism_tada65_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Skene_lvl2/Autism_tada65/Autism_tada65_scaled10k.top15.pdf", width = 50,height=22,limitsize=FALSE)
ggsave(p4,filename = "../Plots/Skene_lvl2/Autism_tada65/Autism_tada65_scaled1pergene.top15.pdf", width = 50,height=22,limitsize=FALSE)
```

### Antipsychotics

```{r}
p <- plot_gene_set_scaled10k(skene_lvl2,ap$X1)
p2 <- plot_gene_set_scaled1pergene(skene_lvl2,ap$X1)
p3 <- plot_gene_set_scaled10k_top15(skene_lvl2,ap$X1)
p4 <- plot_gene_set_scaled1pergene_top15(skene_lvl2,ap$X1)

dir.create("../Plots/Skene_lvl2/Antipsychotics/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl2/Antipsychotics/Antipsychotics_scaled10k.pdf", width = 16,height=28)
#ggsave(p2,filename = "../Plots/Skene_lvl2/Antipsychotics/Antipsychotics_scaled1pergene.pdf", width = 16,height=28)
ggsave(p3,filename = "../Plots/Skene_lvl2/Antipsychotics/Antipsychotics_scaled10k.top15.pdf", width = 50,height=20,limitsize=FALSE)
ggsave(p4,filename = "../Plots/Skene_lvl2/Antipsychotics/Antipsychotics_scaled1pergene.top15.pdf", width = 50,height=20,limitsize=FALSE)
```

### SYNGO postsynaptic strucutral constituent

```{r}
syngo_postsynapse_struct <- syngoBP$ENTREZ[ifelse(syngoBP$`structural constituent of postsynapse (GO:0099186)`==1,TRUE,FALSE)]
p <- plot_gene_set_scaled10k(skene_lvl2,syngo_postsynapse_struct)
p2 <- plot_gene_set_scaled1pergene(skene_lvl2,syngo_postsynapse_struct)
p3 <- plot_gene_set_scaled10k_top15(skene_lvl2,syngo_postsynapse_struct)
p4 <- plot_gene_set_scaled1pergene_top15(skene_lvl2,syngo_postsynapse_struct)

dir.create("../Plots/Skene_lvl2/SYNGO_postsynapse_struct/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl2/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl2/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Skene_lvl2/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.top15.pdf", width = 24,height=18)
ggsave(p4,filename = "../Plots/Skene_lvl2/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.top15.pdf", width = 24,height=18)
```

### Parkinson Klein 2012

```{r}
p <- plot_gene_set_scaled10k(skene_lvl2,park)
p2 <- plot_gene_set_scaled1pergene(skene_lvl2,park)
p3 <- plot_gene_set_scaled10k_top15(skene_lvl2,park)
p4 <- plot_gene_set_scaled1pergene_top15(skene_lvl2,park)

dir.create("../Plots/Skene_lvl2/Parkinson_Klein/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl2/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl2/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Skene_lvl2/Parkinson_Klein/Parkinson_Klein_scaled10k.top15.pdf", width = 24,height=9)
ggsave(p4,filename = "../Plots/Skene_lvl2/Parkinson_Klein/Parkinson_Klein_scaled1pergene.top15.pdf", width = 24,height=9)
```

```{r}
p <- plot_gene_set_scaled10k(skene_lvl2,park2$Parkinsonism)
p2 <- plot_gene_set_scaled1pergene(skene_lvl2,park2$Parkinsonism)
p3 <- plot_gene_set_scaled10k_top15(skene_lvl2,park2$Parkinsonism)
p4 <- plot_gene_set_scaled1pergene_top15(skene_lvl2,park2$Parkinsonism)

dir.create("../Plots/Skene_lvl2/Parkinsonism/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl2/Parkinsonism/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl2/Parkinsonism/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Skene_lvl2/Parkinsonism/Parkinsonism_scaled10k.top15.pdf", width = 50,height=20,limitsize = FALSE)
ggsave(p4,filename = "../Plots/Skene_lvl2/Parkinsonism/Parkinsonism_scaled1pergene.top15.pdf", width = 50,height=20,limitsize = FALSE)
```

## Zeisel

### Test 

```{r}
p1 <- plot_gene_set_scaled10k_top15(zeisel,gene_set_test) + ggtitle("Scaled 10k")
p2 <- plot_gene_set_scaled1pergene_top15(zeisel,gene_set_test) + ggtitle("Scaled 1 UMI per gene")
p <- p1 + p2 
dir.create("../Plots/Zeisel/Test/",showWarnings = FALSE,recursive = TRUE)
ggsave(p,filename = "../Plots/Zeisel/Test/test_genes.top15.pdf", width = 32,height=5)
```

### SCZ Coloc

Paper: Landscape of Conditional eQTL in Dorsolateral Prefrontal Cortex and Co-localization with Schizophrenia GWAS

```{r}
p <- plot_gene_set_scaled10k(zeisel,gene_set_coloc$X1)
p2 <- plot_gene_set_scaled1pergene(zeisel,gene_set_coloc$X1)
p3 <- plot_gene_set_scaled10k_top15(zeisel,gene_set_coloc$X1)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel,gene_set_coloc$X1)

dir.create("../Plots/Zeisel/SCZ_coloc/")
#ggsave(p,filename = "../Plots/Zeisel/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf", width = 16,height=20)
#ggsave(p2,filename = "../Plots/Zeisel/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.pdf", width = 16,height=20)
ggsave(p3,filename = "../Plots/Zeisel/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf.top15.pdf", width = 36,height=20)
ggsave(p4,filename = "../Plots/Zeisel/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.top15.pdf", width = 36,height=20)
```

### SCZ Exome   

```{r}
p <- plot_gene_set_scaled10k(zeisel,gene_set_exome$geneName)
p2 <- plot_gene_set_scaled1pergene(zeisel,gene_set_exome$geneName)
p3 <- plot_gene_set_scaled10k_top15(zeisel,gene_set_exome$geneName)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel,gene_set_exome$geneName)

dir.create("../Plots/Zeisel/SCZ_exome/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/SCZ_exome/SCZ_exome_scaled10k.pdf", width = 12,height=10)
#ggsave(p2,filename = "../Plots/Zeisel/SCZ_exome/SCZ_exome_scaled1pergene.pdf", width = 12,height=10)
ggsave(p3,filename = "../Plots/Zeisel/SCZ_exome/SCZ_exome_scaled10k.top15.pdf", width = 24,height=10)
ggsave(p4,filename = "../Plots/Zeisel/SCZ_exome/SCZ_exome_scaled1pergene.top15.pdf", width = 24,height=10)
```

### Autism TADA 65   

```{r}
p <- plot_gene_set_scaled10k(zeisel,tada65$asd.tada65)
p2 <- plot_gene_set_scaled1pergene(zeisel,tada65$asd.tada65)
p3 <- plot_gene_set_scaled10k_top15(zeisel,tada65$asd.tada65)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel,tada65$asd.tada65)

dir.create("../Plots/Zeisel/Autism_tada65/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/Autism_tada65/Autism_tada65_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Zeisel/Autism_tada65/Autism_tada65_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Zeisel/Autism_tada65/Autism_tada65_scaled10k.top15.pdf", width = 46,height=22)
ggsave(p4,filename = "../Plots/Zeisel/Autism_tada65/Autism_tada65_scaled1pergene.top15.pdf", width = 46,height=22)
```

### Antipsychotics

```{r}
p <- plot_gene_set_scaled10k(zeisel,ap$X1)
p2 <- plot_gene_set_scaled1pergene(zeisel,ap$X1)
p3 <- plot_gene_set_scaled10k_top15(zeisel,ap$X1)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel,ap$X1)

dir.create("../Plots/Zeisel/Antipsychotics/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/Antipsychotics/Antipsychotics_scaled10k.pdf", width = 16,height=28)
#ggsave(p2,filename = "../Plots/Zeisel/Antipsychotics/Antipsychotics_scaled1pergene.pdf", width = 16,height=28)
ggsave(p3,filename = "../Plots/Zeisel/Antipsychotics/Antipsychotics_scaled10k.top15.pdf", width = 50,height=30,limitsize = FALSE)
ggsave(p4,filename = "../Plots/Zeisel/Antipsychotics/Antipsychotics_scaled1pergene.top15.pdf", width = 50,height=30,limitsize = FALSE)
```

### SYNGO postsynaptic strucutral constituent

```{r}
syngo_postsynapse_struct <- syngoBP$ENTREZ[ifelse(syngoBP$`structural constituent of postsynapse (GO:0099186)`==1,TRUE,FALSE)]
p <- plot_gene_set_scaled10k(zeisel,syngo_postsynapse_struct)
p2 <- plot_gene_set_scaled1pergene(zeisel,syngo_postsynapse_struct)
p3 <- plot_gene_set_scaled10k_top15(zeisel,syngo_postsynapse_struct)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel,syngo_postsynapse_struct)

dir.create("../Plots/Zeisel/SYNGO_postsynapse_struct/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Zeisel/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Zeisel/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.top15.pdf", width = 24,height=18)
ggsave(p4,filename = "../Plots/Zeisel/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.top15.pdf", width = 24,height=18)
```

### Parkinson Klein 2012

```{r}
p <- plot_gene_set_scaled10k(zeisel,park)
p2 <- plot_gene_set_scaled1pergene(zeisel,park)
p3 <- plot_gene_set_scaled10k_top15(zeisel,park)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel,park)

dir.create("../Plots/Zeisel/Parkinson_Klein/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Zeisel/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Zeisel/Parkinson_Klein/Parkinson_Klein_scaled10k.top15.pdf", width = 16,height=9)
ggsave(p4,filename = "../Plots/Zeisel/Parkinson_Klein/Parkinson_Klein_scaled1pergene.top15.pdf", width = 16,height=9)
```

```{r}
p <- plot_gene_set_scaled10k(zeisel,park2$Parkinsonism)
p2 <- plot_gene_set_scaled1pergene(zeisel,park2$Parkinsonism)
p3 <- plot_gene_set_scaled10k_top15(zeisel,park2$Parkinsonism)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel,park2$Parkinsonism)

dir.create("../Plots/Zeisel/Parkinsonism/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl2/Parkinsonism/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl2/Parkinsonism/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Zeisel/Parkinsonism/Parkinsonism_scaled10k.top15.pdf", width = 50,height=30,limitsize = FALSE)
ggsave(p4,filename = "../Plots/Zeisel/Parkinsonism/Parkinsonism_scaled1pergene.top15.pdf", width = 50,height=30,limitsize = FALSE)
```


## Zeisel lvl4

### Test 


```{r}
p1 <- plot_gene_set_scaled10k_top15(zeisel_lvl4,gene_set_test) + ggtitle("Scaled 10k")
p2 <- plot_gene_set_scaled1pergene_top15(zeisel_lvl4,gene_set_test) + ggtitle("Scaled 1 UMI per gene")
p <- p1 + p2 
dir.create("../Plots/Zeisel_lvl4/Test/",showWarnings = FALSE,recursive = TRUE)
ggsave(p,filename = "../Plots/Zeisel_lvl4/Test/test_genes.top15.pdf", width = 32,height=5)
```

### SCZ Coloc

Paper: Landscape of Conditional eQTL in Dorsolateral Prefrontal Cortex and Co-localization with Schizophrenia GWAS

```{r}
p <- plot_gene_set_scaled10k(zeisel_lvl4,gene_set_coloc$X1)
p2 <- plot_gene_set_scaled1pergene(zeisel_lvl4,gene_set_coloc$X1)
p3 <- plot_gene_set_scaled10k_top15(zeisel_lvl4,gene_set_coloc$X1)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel_lvl4,gene_set_coloc$X1)

dir.create("../Plots/Zeisel_lvl4/SCZ_coloc/")
#ggsave(p,filename = "../Plots/Zeisel_lvl4/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf", width = 16,height=20)
#ggsave(p2,filename = "../Plots/Zeisel_lvl4/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.pdf", width = 16,height=20)
ggsave(p3,filename = "../Plots/Zeisel_lvl4/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf.top15.pdf", width = 36,height=20)
ggsave(p4,filename = "../Plots/Zeisel_lvl4/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.top15.pdf", width = 36,height=20)
```

### SCZ Exome   

```{r}
p <- plot_gene_set_scaled10k(zeisel_lvl4,gene_set_exome$geneName)
p2 <- plot_gene_set_scaled1pergene(zeisel_lvl4,gene_set_exome$geneName)
p3 <- plot_gene_set_scaled10k_top15(zeisel_lvl4,gene_set_exome$geneName)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel_lvl4,gene_set_exome$geneName)

dir.create("../Plots/Zeisel_lvl4/SCZ_exome/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel_lvl4/SCZ_exome/SCZ_exome_scaled10k.pdf", width = 12,height=10)
#ggsave(p2,filename = "../Plots/Zeisel_lvl4/SCZ_exome/SCZ_exome_scaled1pergene.pdf", width = 12,height=10)
ggsave(p3,filename = "../Plots/Zeisel_lvl4/SCZ_exome/SCZ_exome_scaled10k.top15.pdf", width = 24,height=10)
ggsave(p4,filename = "../Plots/Zeisel_lvl4/SCZ_exome/SCZ_exome_scaled1pergene.top15.pdf", width = 24,height=10)
```

### Autism TADA 65   

```{r}
p <- plot_gene_set_scaled10k(zeisel_lvl4,tada65$asd.tada65)
p2 <- plot_gene_set_scaled1pergene(zeisel_lvl4,tada65$asd.tada65)
p3 <- plot_gene_set_scaled10k_top15(zeisel_lvl4,tada65$asd.tada65)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel_lvl4,tada65$asd.tada65)

dir.create("../Plots/Zeisel_lvl4/Autism_tada65/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/Autism_tada65/Autism_tada65_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Zeisel/Autism_tada65/Autism_tada65_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Zeisel_lvl4/Autism_tada65/Autism_tada65_scaled10k.top15.pdf", width = 46,height=22)
ggsave(p4,filename = "../Plots/Zeisel_lvl4/Autism_tada65/Autism_tada65_scaled1pergene.top15.pdf", width = 46,height=22)
```

### Antipsychotics

```{r}
p <- plot_gene_set_scaled10k(zeisel_lvl4,ap$X1)
p2 <- plot_gene_set_scaled1pergene(zeisel_lvl4,ap$X1)
p3 <- plot_gene_set_scaled10k_top15(zeisel_lvl4,ap$X1)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel_lvl4,ap$X1)

dir.create("../Plots/Zeisel_lvl4/Antipsychotics/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/Antipsychotics/Antipsychotics_scaled10k.pdf", width = 16,height=28)
#ggsave(p2,filename = "../Plots/Zeisel/Antipsychotics/Antipsychotics_scaled1pergene.pdf", width = 16,height=28)
ggsave(p3,filename = "../Plots/Zeisel_lvl4/Antipsychotics/Antipsychotics_scaled10k.top15.pdf", width = 50,height=30,limitsize = FALSE)
ggsave(p4,filename = "../Plots/Zeisel_lvl4/Antipsychotics/Antipsychotics_scaled1pergene.top15.pdf", width = 50,height=30,limitsize = FALSE)
```

### SYNGO postsynaptic strucutral constituent

```{r}
syngo_postsynapse_struct <- syngoBP$ENTREZ[ifelse(syngoBP$`structural constituent of postsynapse (GO:0099186)`==1,TRUE,FALSE)]
p <- plot_gene_set_scaled10k(zeisel_lvl4,syngo_postsynapse_struct)
p2 <- plot_gene_set_scaled1pergene(zeisel_lvl4,syngo_postsynapse_struct)
p3 <- plot_gene_set_scaled10k_top15(zeisel_lvl4,syngo_postsynapse_struct)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel_lvl4,syngo_postsynapse_struct)

dir.create("../Plots/Zeisel_lvl4//SYNGO_postsynapse_struct/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Zeisel/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Zeisel_lvl4/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.top15.pdf", width = 24,height=18)
ggsave(p4,filename = "../Plots/Zeisel_lvl4/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.top15.pdf", width = 24,height=18)
```

### Parkinson Klein 2012

```{r}
p <- plot_gene_set_scaled10k(zeisel_lvl4,park)
p2 <- plot_gene_set_scaled1pergene(zeisel_lvl4,park)
p3 <- plot_gene_set_scaled10k_top15(zeisel_lvl4,park)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel_lvl4,park)

dir.create("../Plots/Zeisel_lvl4//Parkinson_Klein/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Zeisel/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Zeisel/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Zeisel_lvl4/Parkinson_Klein/Parkinson_Klein_scaled10k.top15.pdf", width = 16,height=9)
ggsave(p4,filename = "../Plots/Zeisel_lvl4/Parkinson_Klein/Parkinson_Klein_scaled1pergene.top15.pdf", width = 16,height=9)
```

```{r}
p <- plot_gene_set_scaled10k(zeisel_lvl4,park2$Parkinsonism)
p2 <- plot_gene_set_scaled1pergene(zeisel_lvl4,park2$Parkinsonism)
p3 <- plot_gene_set_scaled10k_top15(zeisel_lvl4,park2$Parkinsonism)
p4 <- plot_gene_set_scaled1pergene_top15(zeisel_lvl4,park2$Parkinsonism)

dir.create("../Plots/Zeisel_lvl4/Parkinsonism/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl2/Parkinsonism/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl2/Parkinsonism/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Zeisel_lvl4/Parkinsonism/Parkinsonism_scaled10k.top15.pdf", width = 50,height=30,limitsize = FALSE)
ggsave(p4,filename = "../Plots/Zeisel_lvl4/Parkinsonism/Parkinsonism_scaled1pergene.top15.pdf", width = 50,height=30,limitsize = FALSE)
```


## Habib

### Test 

```{r}
p1 <- plot_gene_set_scaled10k(habib,gene_set_test) + ggtitle("Scaled 10k")
p2 <- plot_gene_set_scaled1pergene(habib,gene_set_test) + ggtitle("Scaled 1 UMI per gene")
p <- p1 + p2
dir.create("../Plots/Habib//Test/",showWarnings = FALSE,recursive = TRUE)
ggsave(p,filename = "../Plots/Habib/Test/test_genes.pdf", width = 12,height=5)
```

```{r}
p1 <- plot_gene_set_scaled10k_top15(habib,gene_set_test) + ggtitle("Scaled 10k")
p2 <- plot_gene_set_scaled1pergene_top15(habib,gene_set_test) + ggtitle("Scaled 1 UMI per gene")
p <- p1 + p2 
dir.create("../Plots/Habib/Test/",showWarnings = FALSE,recursive = TRUE)
ggsave(p,filename = "../Plots/Habib/Test/test_genes.top15.pdf", width = 24,height=5)
```

### SCZ Coloc

Paper: Landscape of Conditional eQTL in Dorsolateral Prefrontal Cortex and Co-localization with Schizophrenia GWAS

```{r}
p <- plot_gene_set_scaled10k(habib,gene_set_coloc$X1)
p2 <- plot_gene_set_scaled1pergene(habib,gene_set_coloc$X1)
p3 <- plot_gene_set_scaled10k_top15(habib,gene_set_coloc$X1)
p4 <- plot_gene_set_scaled1pergene_top15(habib,gene_set_coloc$X1)

dir.create("../Plots/Habib/SCZ_coloc/")
#ggsave(p,filename = "../Plots/Habib/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf", width = 16,height=20)
#ggsave(p2,filename = "../Plots/Habib/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.pdf", width = 16,height=20)
ggsave(p3,filename = "../Plots/Habib/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf.top15.pdf", width = 24,height=20)
ggsave(p4,filename = "../Plots/Habib/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.top15.pdf", width = 24,height=20)
```

### SCZ Exome   

```{r}
p <- plot_gene_set_scaled10k(habib,gene_set_exome$geneName)
p2 <- plot_gene_set_scaled1pergene(habib,gene_set_exome$geneName)
p3 <- plot_gene_set_scaled10k_top15(habib,gene_set_exome$geneName)
p4 <- plot_gene_set_scaled1pergene_top15(habib,gene_set_exome$geneName)

dir.create("../Plots/Habib/SCZ_exome/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Habib/SCZ_exome/SCZ_exome_scaled10k.pdf", width = 12,height=10)
#ggsave(p2,filename = "../Plots/Habib/SCZ_exome/SCZ_exome_scaled1pergene.pdf", width = 12,height=10)
ggsave(p3,filename = "../Plots/Habib/SCZ_exome/SCZ_exome_scaled10k.top15.pdf", width = 12,height=10)
ggsave(p4,filename = "../Plots/Habib/SCZ_exome/SCZ_exome_scaled1pergene.top15.pdf", width = 12,height=10)
```

### Autism TADA 65   

```{r}
p <- plot_gene_set_scaled10k(habib,tada65$asd.tada65)
p2 <- plot_gene_set_scaled1pergene(habib,tada65$asd.tada65)
p3 <- plot_gene_set_scaled10k_top15(habib,tada65$asd.tada65)
p4 <- plot_gene_set_scaled1pergene_top15(habib,tada65$asd.tada65)

dir.create("../Plots/Habib/Autism_tada65/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Habib/Autism_tada65/Autism_tada65_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Habib/Autism_tada65/Autism_tada65_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Habib/Autism_tada65/Autism_tada65_scaled10k.top15.pdf", width = 30,height=22)
ggsave(p4,filename = "../Plots/Habib/Autism_tada65/Autism_tada65_scaled1pergene.top15.pdf", width = 30,height=22)
```

### Antipsychotics

```{r}
p <- plot_gene_set_scaled10k(habib,ap$X1)
p2 <- plot_gene_set_scaled1pergene(habib,ap$X1)
p3 <- plot_gene_set_scaled10k_top15(habib,ap$X1)
p4 <- plot_gene_set_scaled1pergene_top15(habib,ap$X1)

dir.create("../Plots/Habib/Antipsychotics/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Habib/Antipsychotics/Antipsychotics_scaled10k.pdf", width = 16,height=28)
#ggsave(p2,filename = "../Plots/Habib/Antipsychotics/Antipsychotics_scaled1pergene.pdf", width = 16,height=28)
ggsave(p3,filename = "../Plots/Habib/Antipsychotics/Antipsychotics_scaled10k.top15.pdf", width = 40,height=20)
ggsave(p4,filename = "../Plots/Habib/Antipsychotics/Antipsychotics_scaled1pergene.top15.pdf", width = 40,height=20)
```

### SYNGO postsynaptic strucutral constituent

```{r}
syngo_postsynapse_struct <- syngoBP$ENTREZ[ifelse(syngoBP$`structural constituent of postsynapse (GO:0099186)`==1,TRUE,FALSE)]
p <- plot_gene_set_scaled10k(habib,syngo_postsynapse_struct)
p2 <- plot_gene_set_scaled1pergene(habib,syngo_postsynapse_struct)
p3 <- plot_gene_set_scaled10k_top15(habib,syngo_postsynapse_struct)
p4 <- plot_gene_set_scaled1pergene_top15(habib,syngo_postsynapse_struct)

dir.create("../Plots/Habib/SYNGO_postsynapse_struct/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Habib/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Habib/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Habib/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.top15.pdf", width = 24,height=18)
ggsave(p4,filename = "../Plots/Habib/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.top15.pdf", width = 24,height=18)
```

### Parkinson Klein 2012

```{r}
p <- plot_gene_set_scaled10k(habib,park)
p2 <- plot_gene_set_scaled1pergene(habib,park)
p3 <- plot_gene_set_scaled10k_top15(habib,park)
p4 <- plot_gene_set_scaled1pergene_top15(habib,park)

dir.create("../Plots/Habib/Parkinson_Klein/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Habib/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Habib/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Habib/Parkinson_Klein/Parkinson_Klein_scaled10k.top15.pdf", width = 12,height=9)
ggsave(p4,filename = "../Plots/Habib/Parkinson_Klein/Parkinson_Klein_scaled1pergene.top15.pdf", width = 12,height=9)
```

```{r}
p <- plot_gene_set_scaled10k(habib,park2$Parkinsonism)
p2 <- plot_gene_set_scaled1pergene(habib,park2$Parkinsonism)
p3 <- plot_gene_set_scaled10k_top15(habib,park2$Parkinsonism)
p4 <- plot_gene_set_scaled1pergene_top15(habib,park2$Parkinsonism)

dir.create("../Plots/Habib/Parkinsonism/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl2/Parkinsonism/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl2/Parkinsonism/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Habib/Parkinsonism/Parkinsonism_scaled10k.top15.pdf", width = 40,height=20,limitsize = FALSE)
ggsave(p4,filename = "../Plots/Habib/Parkinsonism/Parkinsonism_scaled1pergene.top15.pdf", width = 40,height=20,limitsize = FALSE)
```

## Lake

### Test 

```{r}
p1 <- plot_gene_set_scaled10k(lake,gene_set_test) + ggtitle("Scaled 10k")
p2 <- plot_gene_set_scaled1pergene(lake,gene_set_test) + ggtitle("Scaled 1 UMI per gene")
p <- p1 + p2
dir.create("../Plots/Lake/Test/",showWarnings = FALSE,recursive = TRUE)
ggsave(p,filename = "../Plots/Lake/Test/test_genes.pdf", width = 12,height=20)
```

```{r}
p1 <- plot_gene_set_scaled10k_top15(lake,gene_set_test) + ggtitle("Scaled 10k")
p2 <- plot_gene_set_scaled1pergene_top15(lake,gene_set_test) + ggtitle("Scaled 1 UMI per gene")
p <- p1 + p2 
dir.create("../Plots/Lake/Test/",showWarnings = FALSE,recursive = TRUE)
ggsave(p,filename = "../Plots/Lake/Test/test_genes.top15.pdf", width = 12,height=20)
```

### SCZ Coloc

Paper: Landscape of Conditional eQTL in Dorsolateral Prefrontal Cortex and Co-localization with Schizophrenia GWAS

```{r}
p <- plot_gene_set_scaled10k(lake,gene_set_coloc$X1)
p2 <- plot_gene_set_scaled1pergene(lake,gene_set_coloc$X1)
p3 <- plot_gene_set_scaled10k_top15(lake,gene_set_coloc$X1)
p4 <- plot_gene_set_scaled1pergene_top15(lake,gene_set_coloc$X1)

dir.create("../Plots/Lake/SCZ_coloc/")
#ggsave(p,filename = "../Plots/Lake/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf", width = 16,height=20)
#ggsave(p2,filename = "../Plots/Lake/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.pdf", width = 16,height=20)
ggsave(p3,filename = "../Plots/Lake/SCZ_coloc/coloc_CMC_conditional_scaled10k.pdf.top15.pdf", width = 24,height=20)
ggsave(p4,filename = "../Plots/Lake/SCZ_coloc/coloc_CMC_conditional_scaled1pergene.top15.pdf", width = 24,height=20)
```

### SCZ Exome   

```{r}
p <- plot_gene_set_scaled10k(lake,gene_set_exome$geneName)
p2 <- plot_gene_set_scaled1pergene(lake,gene_set_exome$geneName)
p3 <- plot_gene_set_scaled10k_top15(lake,gene_set_exome$geneName)
p4 <- plot_gene_set_scaled1pergene_top15(lake,gene_set_exome$geneName)

dir.create("../Plots/Lake/SCZ_exome/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Lake/SCZ_exome/SCZ_exome_scaled10k.pdf", width = 12,height=10)
#ggsave(p2,filename = "../Plots/Lake/SCZ_exome/SCZ_exome_scaled1pergene.pdf", width = 12,height=10)
ggsave(p3,filename = "../Plots/Lake/SCZ_exome/SCZ_exome_scaled10k.top15.pdf", width = 12,height=10)
ggsave(p4,filename = "../Plots/Lake/SCZ_exome/SCZ_exome_scaled1pergene.top15.pdf", width = 12,height=10)
```

### Autism TADA 65   

```{r}
p <- plot_gene_set_scaled10k(lake,tada65$asd.tada65)
p2 <- plot_gene_set_scaled1pergene(lake,tada65$asd.tada65)
p3 <- plot_gene_set_scaled10k_top15(lake,tada65$asd.tada65)
p4 <- plot_gene_set_scaled1pergene_top15(lake,tada65$asd.tada65)

dir.create("../Plots/Lake/Autism_tada65/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Lake/Autism_tada65/Autism_tada65_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Lake/Autism_tada65/Autism_tada65_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Lake/Autism_tada65/Autism_tada65_scaled10k.top15.pdf", width = 30,height=22)
ggsave(p4,filename = "../Plots/Lake/Autism_tada65/Autism_tada65_scaled1pergene.top15.pdf", width = 30,height=22)
```

### Antipsychotics

```{r}
p <- plot_gene_set_scaled10k(lake,ap$X1)
p2 <- plot_gene_set_scaled1pergene(lake,ap$X1)
p3 <- plot_gene_set_scaled10k_top15(lake,ap$X1)
p4 <- plot_gene_set_scaled1pergene_top15(lake,ap$X1)

dir.create("../Plots/Lake/Antipsychotics/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Lake/Antipsychotics/Antipsychotics_scaled10k.pdf", width = 16,height=28)
#ggsave(p2,filename = "../Plots/Lake/Antipsychotics/Antipsychotics_scaled1pergene.pdf", width = 16,height=28)
ggsave(p3,filename = "../Plots/Lake/Antipsychotics/Antipsychotics_scaled10k.top15.pdf", width = 40,height=20)
ggsave(p4,filename = "../Plots/Lake/Antipsychotics/Antipsychotics_scaled1pergene.top15.pdf", width = 40,height=20)
```

### SYNGO postsynaptic strucutral constituent

```{r}
syngo_postsynapse_struct <- syngoBP$ENTREZ[ifelse(syngoBP$`structural constituent of postsynapse (GO:0099186)`==1,TRUE,FALSE)]
p <- plot_gene_set_scaled10k(lake,syngo_postsynapse_struct)
p2 <- plot_gene_set_scaled1pergene(lake,syngo_postsynapse_struct)
p3 <- plot_gene_set_scaled10k_top15(lake,syngo_postsynapse_struct)
p4 <- plot_gene_set_scaled1pergene_top15(lake,syngo_postsynapse_struct)

dir.create("../Plots/Lake/SYNGO_postsynapse_struct/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Lake/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Lake/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Lake/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.top15.pdf", width = 24,height=18)
ggsave(p4,filename = "../Plots/Lake/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.top15.pdf", width = 24,height=18)
```

### Parkinson Klein 2012

```{r}
p <- plot_gene_set_scaled10k(lake,park)
p2 <- plot_gene_set_scaled1pergene(lake,park)
p3 <- plot_gene_set_scaled10k_top15(lake,park)
p4 <- plot_gene_set_scaled1pergene_top15(lake,park)

dir.create("../Plots/Lake/Parkinson_Klein/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Lake/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Lake/SYNGO_postsynapse_struct/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Lake/Parkinson_Klein/Parkinson_Klein_scaled10k.top15.pdf", width = 12,height=9)
ggsave(p4,filename = "../Plots/Lake/Parkinson_Klein/Parkinson_Klein_scaled1pergene.top15.pdf", width = 12,height=9)
```

```{r}
p <- plot_gene_set_scaled10k(lake,park2$Parkinsonism)
p2 <- plot_gene_set_scaled1pergene(lake,park2$Parkinsonism)
p3 <- plot_gene_set_scaled10k_top15(lake,park2$Parkinsonism)
p4 <- plot_gene_set_scaled1pergene_top15(lake,park2$Parkinsonism)

dir.create("../Plots/Lake/Parkinsonism/",showWarnings = FALSE,recursive = TRUE)
#ggsave(p,filename = "../Plots/Skene_lvl2/Parkinsonism/SYNGO_postsynapse_struct_scaled10k.pdf", width = 16,height=24)
#ggsave(p2,filename = "../Plots/Skene_lvl2/Parkinsonism/SYNGO_postsynapse_struct_scaled1pergene.pdf", width = 16,height=24)
ggsave(p3,filename = "../Plots/Lake/Parkinsonism/Parkinsonism_scaled10k.top15.pdf", width = 40,height=20,limitsize = FALSE)
ggsave(p4,filename = "../Plots/Lake/Parkinsonism/Parkinsonism_scaled1pergene.top15.pdf", width = 40,height=20,limitsize = FALSE)
```


